1
00:00:00,660 --> 00:00:01,880
Hello everyone!

2
00:00:02,040 --> 00:00:05,520
In the last video, we discussed how

3
00:00:02,040 --> 00:00:05,520
we are going to download the captions.

4
00:00:05,820 --> 00:00:11,620
And in this video, we're going to move to the final part

5
00:00:05,820 --> 00:00:11,620
of this project which is writing captions to

6
00:00:11,640 --> 00:00:14,460
an Excel file.

7
00:00:14,460 --> 00:00:20,370
Now the idea behind that is that previously when

8
00:00:14,460 --> 00:00:20,370
you were writing captions we had a separate file for

9
00:00:20,400 --> 00:00:23,070
each image because it would just be a messy

10
00:00:23,070 --> 00:00:29,380
if we had all of it in a single ".txt" file.

11
00:00:23,070 --> 00:00:29,380
It wouldn't be really helpful.

12
00:00:29,400 --> 00:00:36,540
So now what we want to do is we want to have this

13
00:00:29,400 --> 00:00:36,540
in an Excel file because doing

14
00:00:36,550 --> 00:00:42,960
analysis on data for a normal human being, for

15
00:00:36,550 --> 00:00:42,960
a normal person, they really prefer

16
00:00:43,050 --> 00:00:50,780
Excel because of the formulas and the tools

17
00:00:43,050 --> 00:00:50,780
you have to manipulate the data in an Excel file.

18
00:00:50,780 --> 00:00:56,040
You can't really do that with a ".txt" file.

19
00:00:50,780 --> 00:00:56,040
To say you want to find patterns or something else.

20
00:00:56,040 --> 00:01:03,490
It is better that you realize that in an Excel

21
00:00:56,040 --> 00:01:03,490
file, not in the ".txt" file. So speaking of the industry standard,

22
00:01:03,510 --> 00:01:13,030
the Excel file is current industry standard for

23
00:01:03,510 --> 00:01:13,030
most people who are not really into tech but they

24
00:01:13,030 --> 00:01:15,970
want to perform business analytics and stuff like that.

25
00:01:15,970 --> 00:01:18,330
So what they do is they use Excel to do that,

26
00:01:18,370 --> 00:01:28,130
manipulate data with Excel and so now I'm going

27
00:01:18,370 --> 00:01:28,130
to introduce you to the module

28
00:01:28,130 --> 00:01:28,850
"xlswriter".

29
00:01:28,860 --> 00:01:39,390
I'm just going to import it, "from xlswriter

30
00:01:28,860 --> 00:01:39,390
import Workbook". The workbook is basically the Excel

31
00:01:39,390 --> 00:01:41,920
file which is going to be made.

32
00:01:42,210 --> 00:01:45,400
I'm just going to walk you through how this is going to work.

33
00:01:45,840 --> 00:01:55,960
Let's make a function

34
00:01:45,840 --> 00:01:55,960
"write_captions_to_excel_file" and

35
00:01:56,190 --> 00:02:01,630
it is going to accept images as its parameters.

36
00:02:02,100 --> 00:02:05,710
OK, so this is the same images which

37
00:02:02,100 --> 00:02:05,710
we're getting in "downloading_captions".

38
00:02:05,760 --> 00:02:06,310
OK.

39
00:02:08,140 --> 00:02:16,720
Now what we want to do is we're going to create a

40
00:02:08,140 --> 00:02:16,720
"Workbook" object. I say "workbook" and here I'm going to

41
00:02:16,720 --> 00:02:17,740
give it the path,

42
00:02:17,830 --> 00:02:24,290
the caption path. Actually I can pass a caption path here.

43
00:02:24,460 --> 00:02:26,680
So we have the caption folder path here.

44
00:02:26,740 --> 00:02:27,660
Right.

45
00:02:27,730 --> 00:02:32,340
So what I do is "caption_path" plus "captions.xlsx".

46
00:02:32,350 --> 00:02:39,880
What this line is going to do is this line

47
00:02:32,350 --> 00:02:39,880
is going to create an Excel sheet at this path.

48
00:02:40,110 --> 00:02:43,140
So "Workbook" takes one parameter, it actually takes a lot.

49
00:02:43,150 --> 00:02:49,450
But for now for simplicity's sake let's say

50
00:02:43,150 --> 00:02:49,450
that it only takes one parameter which is the path

51
00:02:49,450 --> 00:02:52,170
where the Excel file is going to be created.

52
00:02:52,250 --> 00:02:58,030
Now as soon you have an object, a Workbook,

53
00:02:52,250 --> 00:02:58,030
you have to make sure that you close it.

54
00:02:58,630 --> 00:02:59,560
OK.

55
00:02:59,560 --> 00:03:04,580
And the reason behind that is that ensures the

56
00:02:59,560 --> 00:03:04,580
integrity of the data in that Excel file.

57
00:03:05,290 --> 00:03:11,510
Now that we have an Excel file what we want

58
00:03:05,290 --> 00:03:11,510
to do next is we want to see if there's...

59
00:03:11,830 --> 00:03:15,540
I'm sure you must be familiar with sheets if you have used Exel.

60
00:03:16,000 --> 00:03:22,950
So in Excel basically we have sheet, we can add

61
00:03:16,000 --> 00:03:22,950
sheets like we can have in

62
00:03:23,060 --> 00:03:23,940
a single Excel file,

63
00:03:23,950 --> 00:03:25,570
you can have 10 sheets.

64
00:03:25,630 --> 00:03:28,210
It doesn't matter you can just keep adding them.

65
00:03:28,600 --> 00:03:36,140
Maybe I can show you that.

66
00:03:36,250 --> 00:03:38,310
So let's just open up.

67
00:03:42,760 --> 00:03:43,330
Open.

68
00:03:47,260 --> 00:03:47,600
OK.

69
00:03:47,610 --> 00:03:55,580
So this some Excel file I have and you can see that

70
00:03:47,610 --> 00:03:55,580
there's a sheet one here I can add another sheet

71
00:03:55,620 --> 00:03:57,910
here I can have some other data right.

72
00:03:58,320 --> 00:04:01,450
So to work on an Excel file it's necessary that you have a sheet.

73
00:04:01,620 --> 00:04:02,240
OK.

74
00:04:03,450 --> 00:04:07,940
The data comes on the sheet and you can

75
00:04:03,450 --> 00:04:07,940
have many sheets in a single workbook.

76
00:04:08,220 --> 00:04:10,840
So we say "workbook.add_worksheet".

77
00:04:11,370 --> 00:04:13,960
Let's keep it simple and I'm not passing it any parameter.

78
00:04:13,980 --> 00:04:17,400
So that is going to create

79
00:04:13,980 --> 00:04:17,400
one single worksheet.

80
00:04:17,430 --> 00:04:18,820
Now

81
00:04:18,830 --> 00:04:23,050
I have an object of worksheet.

82
00:04:23,550 --> 00:04:26,180
So I'm at row zero.

83
00:04:26,310 --> 00:04:32,370
So what we would like to do is at row zero or

84
00:04:26,310 --> 00:04:32,370
we would like to have say in the first

85
00:04:32,370 --> 00:04:42,280
column the image names and the second

86
00:04:32,370 --> 00:04:42,280
column their corresponding captions.

87
00:04:42,420 --> 00:04:44,730
So that would really increase the readability here.

88
00:04:44,730 --> 00:04:46,410
So say that I'm at row number two

89
00:04:46,440 --> 00:04:53,090
and seeing the image name here I can

90
00:04:46,440 --> 00:04:53,090
see that it contains this caption, right.

91
00:04:54,020 --> 00:05:04,020
So what I'm going to do is I'm going

92
00:04:54,020 --> 00:05:04,020
to say "worksheet.write", "row".

93
00:05:04,520 --> 00:05:07,340
I'm going to walk you through this

94
00:05:07,430 --> 00:05:09,320
function I'm using right now.

95
00:05:09,470 --> 00:05:10,770
So don't worry about it.

96
00:05:12,700 --> 00:05:15,050
So the first thing I wanted was the image name,

97
00:05:19,280 --> 00:05:27,470
"row", 1, "Caption". Ok, so "write" basically takes three arguments.

98
00:05:27,480 --> 00:05:31,000
It takes more but for simplicity's

99
00:05:27,480 --> 00:05:31,000
sake let's say it takes three arguments.

100
00:05:31,030 --> 00:05:37,920
OK, so the first one is row number on which roll

101
00:05:31,030 --> 00:05:37,920
do you want to write, then the column number

102
00:05:39,730 --> 00:05:46,750
and lastly the value which you want to write in that

103
00:05:39,730 --> 00:05:46,750
place, in that cell you have selected a row and

104
00:05:46,750 --> 00:05:49,020
column number.

105
00:05:49,020 --> 00:05:50,250
So what we...

106
00:05:50,320 --> 00:05:51,660
Oh, I'm sorry.

107
00:05:51,800 --> 00:05:52,120
OK.

108
00:05:52,130 --> 00:05:53,940
So this is the correct function.

109
00:05:53,940 --> 00:05:58,030
So what I'm doing here is I at row zero and column zero.

110
00:05:58,060 --> 00:06:04,520
I'm adding image name and at row zero and column one.

111
00:05:58,060 --> 00:06:04,520
I'm adding caption to that will be here.

112
00:06:04,560 --> 00:06:06,530
It would be image name.

113
00:06:07,230 --> 00:06:08,800
And here would be caption.

114
00:06:08,810 --> 00:06:10,020
OK.

115
00:06:10,140 --> 00:06:11,200
Perfect.

116
00:06:11,730 --> 00:06:19,980
OK, so now that we have these what we want to do is

117
00:06:11,730 --> 00:06:19,980
we want to move forward and we want to have the image

118
00:06:20,100 --> 00:06:21,540
names and the captions here.

119
00:06:21,540 --> 00:06:30,060
So let's get to that. "index, image in enumerate(images)".

120
00:06:33,020 --> 00:06:36,170
So let's get the filename. To the filename,

121
00:06:36,170 --> 00:06:38,600
we are simply going to use this

122
00:06:42,290 --> 00:06:46,600
based on the image id we had actually.

123
00:06:46,810 --> 00:06:48,830
I mean, get the filename from here.

124
00:06:48,960 --> 00:06:49,530
OK.

125
00:06:51,010 --> 00:06:58,240
So this is the filename.

126
00:06:58,250 --> 00:07:01,940
So this is the filename we have and the caption is

127
00:07:04,700 --> 00:07:05,570
"image".

128
00:07:05,790 --> 00:07:12,660
And how we were finding captions it was via "alt",

129
00:07:12,660 --> 00:07:16,350
the attribute "alt". Now seven images

130
00:07:12,660 --> 00:07:16,350
didn't have captions, so this is going to throw an exception.

131
00:07:16,520 --> 00:07:20,150
We need to have this in a "try catch" block.

132
00:07:20,300 --> 00:07:24,530
"exception KeyError", "caption",

133
00:07:24,530 --> 00:07:25,850
"No caption exists".

134
00:07:28,660 --> 00:07:36,650
OK, so now that we have this what we would

135
00:07:28,660 --> 00:07:36,650
like to do next is "worksheet.write",

136
00:07:38,310 --> 00:07:47,840
row and now the idea is that we want

137
00:07:38,310 --> 00:07:47,840
to write two values in a single row.

138
00:07:47,850 --> 00:07:54,630
How do we manage that. One way, the easier

139
00:07:47,850 --> 00:07:54,630
way is that we just hardcode it, "filename"

140
00:08:00,520 --> 00:08:05,830
and "caption" and then I could add this.

141
00:08:06,420 --> 00:08:11,840
That way would be say like you have a lot of column,

142
00:08:06,420 --> 00:08:11,840
so say that you have 100 columns.

143
00:08:11,850 --> 00:08:13,310
This is not a good idea then.

144
00:08:13,340 --> 00:08:19,290
So then what you can do is you can use another for

145
00:08:13,340 --> 00:08:19,290
loop in this for loop we have, so nested loops

146
00:08:19,290 --> 00:08:27,500
to write this Excel sheet. OK, so this should

147
00:08:19,290 --> 00:08:27,500
write our captions to an Excel file.

148
00:08:27,500 --> 00:08:30,480
Let's run this and see if it actually works or not.

149
00:08:30,800 --> 00:08:34,620
I'm going to comment this because

150
00:08:30,800 --> 00:08:34,620
we don't need all those ".txt" files.

151
00:08:36,050 --> 00:08:37,300
So I'm going to call this now.

152
00:08:37,310 --> 00:08:41,890
"self.write_caption_to_excel_file" and it needs images.

153
00:08:41,970 --> 00:08:46,010
I'm going to give it "images", "caption_folder_path".

154
00:08:46,240 --> 00:08:46,790
OK.

155
00:08:46,820 --> 00:08:53,390
Let me open instaPhotos and delete everything we have in captions.

156
00:08:54,140 --> 00:08:55,730
OK, so that's done.

157
00:08:58,070 --> 00:09:03,150
And we can add a print statement here, "writing to excel".

158
00:09:06,790 --> 00:09:10,930
I'm going to run this now and then would know what we have done.

159
00:09:10,930 --> 00:09:12,640
Does it work or not. OK.

160
00:09:16,830 --> 00:09:19,060
There you go.

161
00:09:28,860 --> 00:09:30,090
So opening Instagram,

162
00:09:50,280 --> 00:09:51,520
our target profile,

163
00:09:54,190 --> 00:09:57,410
it is going to load all of the images now on the page,

164
00:09:59,290 --> 00:10:02,040
scrolling down. Good, we are doing good.

165
00:10:08,710 --> 00:10:12,800
Ok, so anytime now it'll start downloading the captions.

166
00:10:20,030 --> 00:10:27,690
So we should have our Excel sheet printed because

167
00:10:20,030 --> 00:10:27,690
it is downloading photos now. Yes, we have it but

168
00:10:27,690 --> 00:10:33,890
the path is wrong. We have it here

169
00:10:27,690 --> 00:10:33,890
and we're supposed to have in

170
00:10:34,020 --> 00:10:44,600
the caption path and the reason behind that is

171
00:10:34,020 --> 00:10:44,600
that I forgot to add a forward slash. I'm going to rerun

172
00:10:44,600 --> 00:10:49,670
this and we should have this now in the captions folder.

173
00:10:49,720 --> 00:10:58,190
OK, I should have added a forward slash

174
00:10:49,720 --> 00:10:58,190
because the "caption_path" only contained

175
00:10:58,220 --> 00:11:07,460
the caption path of this folder we have that's the

176
00:10:58,220 --> 00:11:07,460
reason you should always use "os.path.join" like

177
00:11:07,520 --> 00:11:13,130
we did here to do this because then you're sure

178
00:11:07,520 --> 00:11:13,130
that this is not going to happen like just

179
00:11:13,130 --> 00:11:14,310
happened right now.

180
00:11:16,550 --> 00:11:18,500
And I think I should do that too.

181
00:11:27,690 --> 00:11:32,470
So "os.path.join" and "caption_path".

182
00:11:38,860 --> 00:11:51,510
There we go.

183
00:11:51,650 --> 00:11:56,340
So this is interesting that not all the images

184
00:11:51,650 --> 00:11:56,340
had loaded because it says lenth of all images is 13

185
00:11:58,950 --> 00:12:04,840
which is not true because the

186
00:11:58,950 --> 00:12:04,840
length of all images is thirty one.

187
00:12:04,850 --> 00:12:06,670
So let's see what went wrong.

188
00:12:06,920 --> 00:12:10,460
I'm going to delete everything we have in this insta folder.

189
00:12:12,150 --> 00:12:13,950
Let's close this Excel sheet.

190
00:12:17,830 --> 00:12:18,500
OK.

191
00:12:18,630 --> 00:12:19,830
I'm going to run this again.

192
00:12:19,880 --> 00:12:28,430
This might have only happened

193
00:12:19,880 --> 00:12:28,430
because of the fact that like

194
00:12:28,440 --> 00:12:34,310
scraping is not consistent. The browser,

195
00:12:28,440 --> 00:12:34,310
may be my netbooks speed.

196
00:12:34,310 --> 00:12:35,420
It wasn't good enough.

197
00:12:35,430 --> 00:12:36,580
That's why the

198
00:12:36,750 --> 00:12:38,210
photos didn't load.

199
00:12:38,220 --> 00:12:45,960
And that's probably the most likely reason for

200
00:12:38,220 --> 00:12:45,960
now because there's this thing, it's not

201
00:12:45,960 --> 00:12:46,780
consistent.

202
00:12:46,830 --> 00:12:52,740
You get problems maybe when the SSL handshake

203
00:12:46,830 --> 00:12:52,740
wasn't being performed, something happened.

204
00:12:53,370 --> 00:12:56,960
So it can vary.

205
00:12:57,000 --> 00:12:58,950
OK, let's run this again.

206
00:12:58,950 --> 00:13:04,770
Let's see if we're able to get everything

207
00:12:58,950 --> 00:13:04,770
now and be able to get everything now.

208
00:13:04,890 --> 00:13:05,960
I've commented this.

209
00:13:06,060 --> 00:13:09,670
And you'd also be able to check this, "os.path.join"

210
00:13:09,670 --> 00:13:12,840
we have included.

211
00:13:35,390 --> 00:13:37,430
So this is going to log us in.

212
00:14:15,020 --> 00:14:27,610
So I think it's probably my internet,

213
00:14:15,020 --> 00:14:27,610
you saw that it's really slow.

214
00:14:27,690 --> 00:14:33,440
It should start scrolling down once the initial

215
00:14:27,690 --> 00:14:33,440
page loads, you can still see the search tool.

216
00:14:33,500 --> 00:14:35,350
So that hasn't happened.

217
00:14:35,400 --> 00:14:40,650
Now it stoped scrolling down. OK, it's going down.

218
00:14:40,680 --> 00:14:47,280
We are good and I think we have all the photos.

219
00:14:47,540 --> 00:14:48,800
Let's see.

220
00:14:58,180 --> 00:14:59,500
Yes, we have all of them.

221
00:14:59,500 --> 00:15:02,350
Length of all images is thirty one. Perfect.

222
00:15:02,500 --> 00:15:06,790
So let's get back to our

223
00:15:02,500 --> 00:15:06,790
captions and if I open captions

224
00:15:10,420 --> 00:15:12,810
we can see that we have all the captions

225
00:15:12,810 --> 00:15:13,290
now.

226
00:15:14,870 --> 00:15:15,210
"image_0",

227
00:15:15,210 --> 00:15:17,480
"change profile photo"

228
00:15:17,630 --> 00:15:18,060
and

229
00:15:18,080 --> 00:15:19,100
moving down.

230
00:15:19,330 --> 00:15:22,920
You should have 31 captions and it says me thirty.

231
00:15:22,980 --> 00:15:28,120
And the reason behind that is because

232
00:15:22,980 --> 00:15:28,120
we started counting from zero. So we are good.

233
00:15:28,140 --> 00:15:32,760
And "image_30" also doesn't have any captions.

234
00:15:32,870 --> 00:15:33,590
OK.

235
00:15:33,870 --> 00:15:34,880
Perfect.

236
00:15:34,890 --> 00:15:35,830
So this is working.

237
00:15:35,840 --> 00:15:37,690
I hope this made sense to you.

238
00:15:43,350 --> 00:15:45,440
There are other ways to get this done.

239
00:15:45,450 --> 00:15:51,480
You can use Pandas to write to an Excel file

240
00:15:45,450 --> 00:15:51,480
but the easiest way would probably be using

241
00:15:51,740 --> 00:15:54,210
"xlsxwriter" for this.

242
00:15:54,210 --> 00:15:56,760
And remember you have to close the Workbook.

243
00:15:56,820 --> 00:15:59,280
Always, OK.

244
00:15:59,330 --> 00:16:00,790
I hope this made sense to you.

245
00:16:00,800 --> 00:16:07,800
And if you find any if you have any difficulty

246
00:16:00,800 --> 00:16:07,800
understanding, this if you think that something

247
00:16:07,800 --> 00:16:15,110
is missing or there's another issue, you can always ask

248
00:16:07,800 --> 00:16:15,110
questions and we'll be happy to get back to you

249
00:16:15,230 --> 00:16:16,490
as soon as we can.

250
00:16:16,490 --> 00:16:16,960
Thank you.

